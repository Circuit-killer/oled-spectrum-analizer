# Wixel_adf4351

Noise generators are commonly used for scientific experiments and for testing transceiver or antenna equipment, but with them it is possible to improve the already existing wireless infrastructure.

## Equipment

1. Pololu Wixel ([fritzing part](../../fritzing-parts/OLED%200.96%20128x64%20I2C%20SSD1306.fzpz))
2. OLED 0.96" 128×64 I2C ([fritzing part](../../fritzing-parts/OLED%200.96%20128x64%20I2C%20SSD1306.fzpz)) or SPI ([fritzing part](../../fritzing-parts/OLED%200.96%20128x64%20SPI%20SSD1306.fzpz)) SSD1306
3. ADF4351 Development Board

![Wixel_adf4351_photo](./pics/Wixel_adf4351_5.png)

## Working Principle

The noise generator can be positioned in place of the router, to establish channel (antenna can even take advantage of the router), and with a [spectrum analyzer](https://github.com/Oestoidea/oled-spectrum-analizer/tree/master/Wixel/Wixel_3oleds_ssd1306), track the signal drop in the different parts of the home or office. By changing the position of the noise generator and checking the noise level in the analyzer, you can find the best place for the location of the router.
This generator has a working frequency range from 35 to 4400 MHz, but for our purposes it is sufficient to use only frequencies from 2400 to 2499 MHz in steps of 1 MHz. The values are generated by the program [ADF4350/ADF4351 Evaluation Download now Software Discussion Board](http://www.analog.com/ru/design-center/evaluation-hardware-and-software/evaluation-boards-kits/eval-adf4351.html#eb-relatedsoftware), provided by the manufacturer. Initialization is performed by six registers, which are transmitted via SPI in a certain sequence. Since the frequency calculation algorithm is not a [simple task](https://github.com/s54mtb/ADF4351.git), the private generator has been written for a given set of frequencies.

![Wixel_adf4351_photo](./pics/Wixel_adf4351.png)
 
To achieve a stable initialization with the help of Arduino Nano failed, because the choice fell on Pololu Wixel (which also has a radio module on board). The built-in radio module allows organizing feedback and qualitatively assessing the operability of the transmitting circuit. When the noise generator was initialized, there was a problem with sending packets: every initialization word must be transmitted without pauses. For example, the first word “580005” in the program of the PulseView logic analyzer looks like this:

![Wixel_adf4351_photo](./pics/Wixel_adf4351_2.png)
 
After selecting the frequency and format of the transmission, the device has earned as a clock. The assembly scheme is simple and uses all reserved ports (one I2C and two SPIs).
When you turn on the generator operates on the first channel, but with the buttons, you can increase or decrease the channel number. A frequency reference via the virtual COM port is also available. The command consists only of specifying the frequency number in hexadecimal, so to work at 2445 MHz it is enough to transfer the number 0x2D. If the command is received, the device responds with the 0xFF command.

![Wixel_adf4351_photo](./pics/Wixel_adf4351_4.png)

To check the operation of the device have also been involved three spectrum analyzer: Ubiquiti AirView2, ez430RF2500, and Unigen ISM Sniffer, and the data collection was conducted in [MDRV program](https://github.com/RasAlhague/MDRV.git). All three devices unanimously showed the presence of interference on the 1st channel.

![Wixel_adf4351_photo](./pics/Wixel_adf4351_8.png)

During experiments with a conventional antenna such as a half-wave dipole, devices at a distance of 5 meters practically lost contact with the router, and at 20 meters there were difficulties in receiving and transmitting. Visually, the noise generator is visible in the [WiFi Analyzer application](http://a.farproc.com/wifi-analyzer) on Android. The generator is launched at the middle of the frequency of the 4th channel:

![Wixel_adf4351_photo](./pics/Wixel_adf4351_9.png)

For more information, see [video lesson about ADF4351](https://opentechlab.org.uk/videos:005:notes).

## Wixel

Put the firmware on Wixel with parameters __spi_on__ and __i2c_on__ for the connection type. For example, to compile and download the firmware with [wixel-sdk](http://pololu.github.io/wixel-sdk/) on OS Windows:

```
C:\wixel-sdk>make load_Wixel_adf4351 S="spi_on=0 i2c_on=1"
```

More information about Wixel apps you can see on [official site](https://www.pololu.com/docs/0J46/10.b). This noise generator based on [PLL-Oszillator](http://www.kh-gps.de/adf4351.htm) written by Klaus H. Hirschekmann [Gem.] and [RF Generator](http://f6kbf.free.fr/html/ADF4351%20and%20Arduino_Fr_Gb.htm) written by Alain Fort F1CJN [Fr.].

## Displays and Noise Generator

Connect OLED's and ADF4351 to Wixel as shown on the picture.

![Wixel_adf4351_scheme](./fritzing-scheme/Wixel_adf4351_bb.png)

## Connection Map

| Wixel    | SPI OLED      |
| -------- | ------------- |
| P0_1     | RES           |
| P0_2     | D/C           |
| P0_3     | DIN (SDA)     |
| P0_4     | CS            |
| P0_5     | CLK           |
| 3V3      | VCC           |
| GND      | GND           |

| Wixel    | I2C OLED      |
| -------- | ------------- |
| P1_0     | SCK           |
| P1_1     | SDA           |
| 3V3      | VCC           |
| GND      | GND           |

| Wixel    | ADF4351       |
| -------- | ------------- |
| P1_4     | LE            |
| P1_5     | CLK           |
| P1_6     | DAT (SDA)     |
| 3V3      | 3V3           |
| GND      | GND           |

| Wixel    | Switch        | Function         |
| -------- | ------------- | ---------------- |
| P0_0     | normally open | Pause            |
| P1_2     | normally open | Channel increase |
| P1_3     | normally open | Channel decrease |
| GND      | normally open |                  |

| Wixel    | power supply  |
| -------- | ------------- |
| VIN      | 2.7–6.5V      |
| GND      | GND           |

## Implementation

Wixel, OLED, ADF4351 and external antenna in the housing is shown below. The device was assembled in an acrylic case. Button on the top size — channel increase, and on the bottom — channel decrease.

![Wixel_adf4351_implementation](./pics/Wixel_adf4351_6.png)

![Wixel_adf4351_implementation](./pics/Wixel_adf4351_7.png)